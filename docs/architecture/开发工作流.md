# 开发工作流

## 本地开发设置

### 前置条件

```bash
# 检查Node.js版本
node --version  # 应该 >= 18.0.0

# 检查Java版本
java --version  # 应该 >= 17

# 检查Docker版本
docker --version  # 应该 >= 20.0.0

# 检查pnpm版本
pnpm --version  # 应该 >= 8.0.0
```

### 初始设置

```bash
# 克隆项目
git clone <repository-url>
cd chengdu-hotel-management

# 安装依赖
pnpm install

# 启动数据库服务
docker-compose up -d mysql redis

# 等待数据库启动
sleep 30

# 运行数据库迁移
cd apps/api
./mvnw flyway:migrate

# 返回根目录
cd ../..
```

### 开发命令

```bash
# 启动所有服务（前端 + 后端）
pnpm dev

# 仅启动前端
pnpm dev:frontend

# 仅启动后端
pnpm dev:backend

# 运行所有测试
pnpm test

# 运行前端测试
pnpm test:frontend

# 运行后端测试
pnpm test:backend

# 构建所有应用
pnpm build

# 启动开发环境数据库
docker-compose up -d mysql redis
```

## 环境配置

### 必需环境变量

```bash
# 前端 (.env.local)
VITE_API_BASE_URL=http://localhost:8080/v1
VITE_UPLOAD_URL=http://localhost:8080/v1/files/upload
VITE_APP_TITLE=成都酒店管理系统

# 后端 (.env)
# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_NAME=hotel_management
DB_USERNAME=root
DB_PASSWORD=root

# Redis配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWT配置
JWT_SECRET=your-super-secret-jwt-key-here
JWT_EXPIRATION=86400000

# 文件存储配置
OSS_ACCESS_KEY_ID=your-oss-access-key
OSS_ACCESS_KEY_SECRET=your-oss-secret-key
OSS_BUCKET_NAME=hotel-management
OSS_ENDPOINT=https://oss-cn-hangzhou.aliyuncs.com

# 短信服务配置
SMS_ACCESS_KEY=your-sms-access-key
SMS_SECRET_KEY=your-sms-secret-key
SMS_SIGN_NAME=成都酒店

# 邮件服务配置
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password

# 共享环境变量
NODE_ENV=development
LOG_LEVEL=DEBUG
```
